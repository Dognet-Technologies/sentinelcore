# config/production.yaml
# Production configuration for Vulnerability Manager
# IMPORTANT: Override secrets via environment variables VULN_*

server:
  host: "0.0.0.0"
  port: 8443  # HTTPS port
  enable_tls: true
  tls_cert_path: "/etc/sentinelcore/certs/cert.pem"
  tls_key_path: "/etc/sentinelcore/certs/key.pem"
  request_timeout_seconds: 30
  graceful_shutdown_timeout_seconds: 30

database:
  url: "${DATABASE_URL}"  # Must be set via env var
  max_connections: 50
  min_connections: 5
  connection_timeout_seconds: 30
  idle_timeout_seconds: 600
  max_lifetime_seconds: 1800
  enable_ssl: true

auth:
  secret_key: "${JWT_SECRET}"  # MUST be set via env var - NEVER hardcode
  token_duration_hours: 8  # Shorter for production
  refresh_token_duration_hours: 168  # 7 days
  enable_refresh_tokens: true
  session_timeout_hours: 8
  password_policy:
    min_length: 12  # Stronger for production
    max_length: 128
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_special_chars: true
    special_chars: "!@#$%^&*()_+-=[]{}|;:,.<>?"
    prevent_common_passwords: true

security:
  # CORS Configuration
  cors:
    enabled: true
    allowed_origins:
      - "https://sentinelcore.example.com"  # Replace with your domain
      - "https://app.sentinelcore.example.com"
    allowed_methods:
      - "GET"
      - "POST"
      - "PUT"
      - "DELETE"
      - "PATCH"
    allowed_headers:
      - "Content-Type"
      - "Authorization"
      - "X-CSRF-Token"
    expose_headers:
      - "Content-Length"
      - "X-Request-Id"
    max_age_seconds: 3600
    allow_credentials: true

  # Security Headers
  headers:
    hsts_max_age_seconds: 31536000  # 1 year
    hsts_include_subdomains: true
    hsts_preload: true
    frame_options: "DENY"
    content_type_options: "nosniff"
    xss_protection: "1; mode=block"
    referrer_policy: "strict-origin-when-cross-origin"
    csp: "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"
    permissions_policy: "geolocation=(), microphone=(), camera=()"

  # Rate Limiting
  rate_limit:
    enabled: true
    requests_per_minute: 60
    burst_size: 100
    login_attempts_per_minute: 5
    api_requests_per_minute: 120

  # CSRF Protection
  csrf:
    enabled: true
    cookie_name: "XSRF-TOKEN"
    header_name: "X-CSRF-Token"
    token_length: 32
    secure_cookie: true
    http_only: false  # Must be readable by JS
    same_site: "Strict"

  # Cookie Configuration
  cookies:
    secure: true  # Only HTTPS
    http_only: true  # Prevent XSS
    same_site: "Strict"
    domain: "sentinelcore.example.com"  # Replace with your domain
    path: "/"
    max_age_seconds: 28800  # 8 hours

plugins:
  directory: "/var/lib/sentinelcore/plugins"
  enabled: true
  sandbox_enabled: true  # Future implementation
  max_execution_time_seconds: 300
  max_memory_mb: 512

log:
  level: "info"
  file: "/var/log/sentinelcore/app.log"
  format: "json"  # Better for production log aggregation
  rotation:
    enabled: true
    max_size_mb: 100
    max_files: 10

monitoring:
  enabled: true
  metrics_port: 9090
  health_check_path: "/health"
  readiness_check_path: "/ready"

network:
  interface: "eth0"
  default_scan_timeout: 500
  max_scan_workers: 50
