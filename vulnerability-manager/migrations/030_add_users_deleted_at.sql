-- Migration 030: Add soft delete support for users
-- Date: 2025-12-17
-- Purpose: Add deleted_at column to users table for soft delete functionality

ALTER TABLE users ADD COLUMN IF NOT EXISTS deleted_at TIMESTAMPTZ DEFAULT NULL;

CREATE INDEX IF NOT EXISTS idx_users_deleted_at ON users(deleted_at) WHERE deleted_at IS NULL;

-- Add comment for documentation
COMMENT ON COLUMN users.deleted_at IS 'Timestamp when user was soft-deleted. NULL means active user.';
