-- Migration 032: Add soft delete support for vulnerabilities
-- Date: 2025-12-17
-- Purpose: Add deleted_at column to vulnerabilities table for soft delete functionality

ALTER TABLE vulnerabilities ADD COLUMN IF NOT EXISTS deleted_at TIMESTAMPTZ DEFAULT NULL;

CREATE INDEX IF NOT EXISTS idx_vulnerabilities_deleted_at ON vulnerabilities(deleted_at) WHERE deleted_at IS NULL;

COMMENT ON COLUMN vulnerabilities.deleted_at IS 'Timestamp when vulnerability was soft-deleted. NULL means active vulnerability.';
