-- Fix assets.tags column to have a default empty array
-- This prevents NULL values which cause deserialization errors in Rust

-- Update existing NULL tags to empty array
UPDATE assets SET tags = '{}' WHERE tags IS NULL;

-- Add NOT NULL constraint with default
ALTER TABLE assets ALTER COLUMN tags SET DEFAULT '{}';
ALTER TABLE assets ALTER COLUMN tags SET NOT NULL;
