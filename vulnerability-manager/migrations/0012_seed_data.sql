-- Insert default admin user (password: admin123)
INSERT INTO users (username, password_hash, email, role)
VALUES ('admin', '$argon2id$v=19$m=16,t=2,p=1$NzZJbmtsRzJpSnJZeVVVcg$YiDJHvIB/lbugIUOI+Nc6D3ZLok', 'admin@dognet.tech', 'admin');

-- Insert default team leader user (password: teamleader123)
INSERT INTO users (username, password_hash, email, role)
VALUES ('team_leader', '$argon2id$v=19$m=16,t=2,p=1$VVVKdHFLVmhiTXByRU5vNg$SvK49OLGFKs4jlMjpSPsVoZ0b80', 'teamleader@dognet.tech', 'team_leader');

-- Insert default user (password: user123)
INSERT INTO users (username, password_hash, email, role)
VALUES ('user1', '$argon2id$v=19$m=16,t=2,p=1$VVVKdHFLVmhiTXByRU5vNg$SvK49OLGFKs4jlMjpSPsVoZ0b80', 'user@dognet.tech', 'user');

-- Insert default team
INSERT INTO teams (name, description, contact_email)
VALUES ('IT Security', 'Main security team responsible for vulnerability remediation', 'security@dognet.tech');

-- Insert team members
INSERT INTO team_members (team_id, name, email)
VALUES 
    ((SELECT id FROM teams WHERE name = 'IT Security'), 'John Doe', 'john.doe@dognet.tech'),
    ((SELECT id FROM teams WHERE name = 'IT Security'), 'Jane Smith', 'jane.smith@dognet.tech');

-- Insert sample assets (with tags field)
INSERT INTO assets (name, asset_type, description, ip_address, hostname, operating_system, tags)
VALUES
    ('Web Server', 'server', 'Main web server', '192.168.1.10', 'webserver01.local', 'Linux Ubuntu 22.04', ARRAY['production', 'web']::text[]),
    ('SQL Database', 'server', 'Main database server', '192.168.1.11', 'dbserver01.local', 'Linux CentOS 8', ARRAY['production', 'database']::text[]);

-- Insert sample vulnerabilities
INSERT INTO vulnerabilities (
    title, description, cvss_score, epss_score, ip_address, hostname,
    port, protocol, status, severity, cve_id, remediation, source, discovered_at
)
VALUES (
    'SQL Injection in Web App',
    'A SQL injection vulnerability was found in the login page that could allow attackers to bypass authentication.',
    8.5,
    0.75,
    '192.168.1.10/32',
    'webserver01.local',
    443,
    'HTTPS',
    'open',
    'high',
    'CVE-2023-12345',
    'Update the application to use parameterized queries and apply the latest security patch.',
    'Nessus Scan',
    NOW() - INTERVAL '2 days'
),
(
    'Outdated OpenSSL Version',
    'The server is running an outdated version of OpenSSL that contains known vulnerabilities.',
    6.8,
    0.45,
    '192.168.1.11/32',
    'dbserver01.local',
    5432,
    'TCP',
    'open',
    'medium',
    'CVE-2023-45678',
    'Update OpenSSL to the latest stable version and restart affected services.',
    'Manual Scan',
    NOW() - INTERVAL '1 day'
);