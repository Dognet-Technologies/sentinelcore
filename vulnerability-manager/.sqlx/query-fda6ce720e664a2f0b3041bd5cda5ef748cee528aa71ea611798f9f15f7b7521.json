{
  "db_name": "PostgreSQL",
  "query": "INSERT INTO network_devices\n                         (id, ip_address, mac_address, hostname, device_type, device_status,\n                          vendor, os_name, os_version, open_ports, services, first_seen, last_seen, created_at, updated_at)\n                         VALUES ($1, $2, $3, $4, $5::device_type, $6::device_status, $7, $8, $9, $10, $11, $12, $13, NOW(), NOW())\n                         ON CONFLICT (ip_address)\n                         DO UPDATE SET\n                            mac_address = COALESCE(EXCLUDED.mac_address, network_devices.mac_address),\n                            hostname = COALESCE(EXCLUDED.hostname, network_devices.hostname),\n                            device_status = EXCLUDED.device_status,\n                            last_seen = EXCLUDED.last_seen,\n                            updated_at = NOW()",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Uuid",
        "Inet",
        "Varchar",
        "Varchar",
        {
          "Custom": {
            "name": "device_type",
            "kind": {
              "Enum": [
                "router",
                "switch",
                "firewall",
                "server",
                "workstation",
                "iot",
                "printer",
                "unknown"
              ]
            }
          }
        },
        {
          "Custom": {
            "name": "device_status",
            "kind": {
              "Enum": [
                "online",
                "offline",
                "unknown"
              ]
            }
          }
        },
        "Varchar",
        "Varchar",
        "Varchar",
        "Int4Array",
        "Jsonb",
        "Timestamptz",
        "Timestamptz"
      ]
    },
    "nullable": []
  },
  "hash": "fda6ce720e664a2f0b3041bd5cda5ef748cee528aa71ea611798f9f15f7b7521"
}
