// src/handlers/mod.rs
// FIXED: Rimossi import non utilizzati e corretti gli export

pub mod auth;
pub mod user;
pub mod vulnerability;
pub mod team;
pub mod asset;
pub mod report;
pub mod plugin;
pub mod audit;
pub mod security;
pub mod dashboard;
pub mod management_report;

// Export solo le funzioni effettivamente utilizzate nell'API routing
// Auth functions - ONLY those used in api/mod.rs
pub use auth::{login, logout, refresh_token};

// User functions - regular user functions (used in protected routes)
pub use user::{
    get_current_user, update_current_user, change_password,
    upload_avatar, delete_avatar, get_user_sessions, revoke_session,
    enable_two_factor, disable_two_factor, verify_two_factor,
    get_security_settings, update_security_settings,
    get_reputation_events,
    get_notification_settings, update_notification_settings,
    list_api_keys, create_api_key, revoke_api_key
};

// User functions - admin functions (used in admin routes)
pub use user::{
    list_users, create_user, get_user, update_user, delete_user,
    lock_user, unlock_user, get_user_sessions_admin, revoke_all_user_sessions
};

// Vulnerability functions
pub use vulnerability::{
    list_vulnerabilities, get_vulnerability, create_vulnerability,
    update_vulnerability, delete_vulnerability, assign_to_team
};

// Security functions  
pub use security::{
    get_ip_whitelist, add_ip_whitelist, remove_ip_whitelist,
    get_user_permissions, grant_user_permission, revoke_user_permission
};

// Audit functions
pub use audit::{
    get_audit_logs, create_audit_log, get_audit_log_by_id, get_audit_stats
};

// Team functions
pub use team::{
    list_teams, get_team, create_team, update_team, delete_team,
    add_team_member, remove_team_member, get_team_members
};

// Asset functions
pub use asset::{
    list_assets, get_asset, create_asset, update_asset, delete_asset
};

// Report functions
pub use report::{
    list_reports, get_report, create_report, update_report, delete_report, download_report
};

// Plugin functions
pub use plugin::{
    list_plugins, get_plugin, install_plugin, update_plugin, uninstall_plugin, toggle_plugin
};

// Dashboard functions
pub use dashboard::{
    get_dashboard_stats
};