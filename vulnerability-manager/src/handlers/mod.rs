// src/handlers/mod.rs
// FIXED: Rimossi import non utilizzati e corretti gli export

pub mod auth;
pub mod user;
pub mod vulnerability;
pub mod team;
pub mod asset;
pub mod report;
pub mod plugin;
pub mod audit;
pub mod security;
pub mod dashboard;
pub mod management_report;
pub mod scanner_import;
pub mod remediation_plan;
pub mod workload;
pub mod comments;
pub mod risk_scoring;
pub mod notification_rules;
pub mod jira_integration;
pub mod settings_handler;
pub mod notification;
pub mod compliance_reports;
pub mod soar_webhooks;
pub mod assignment_rules;
pub mod risk_acceptance;
pub mod password_reset;
pub mod resolution_scoring;
pub mod user_notifications;
pub mod auto_assignment;

// Export solo le funzioni effettivamente utilizzate nell'API routing
// Auth functions - ONLY those used in api/mod.rs
pub use auth::{login, logout, refresh_token};

// User functions - regular user functions (used in protected routes)
pub use user::{
    get_current_user, update_current_user, change_password,
    upload_avatar, delete_avatar, get_user_sessions, revoke_session,
    enable_two_factor, disable_two_factor, verify_two_factor,
    get_security_settings, update_security_settings,
    get_reputation_events,
    get_notification_settings, update_notification_settings,
    list_api_keys, create_api_key, revoke_api_key
};

// User functions - admin functions (used in admin routes)
pub use user::{
    list_users, create_user, get_user, update_user, delete_user,
    lock_user, unlock_user, get_user_sessions_admin, revoke_all_user_sessions
};

// Vulnerability functions
pub use vulnerability::{
    list_vulnerabilities, get_vulnerability, create_vulnerability,
    update_vulnerability, delete_vulnerability, assign_to_team,
    assign_to_user, get_my_assigned_vulnerabilities, check_new_vulnerabilities,
    get_vulnerability_timeline
};

// Security functions  
pub use security::{
    get_ip_whitelist, add_ip_whitelist, remove_ip_whitelist,
    get_user_permissions, grant_user_permission, revoke_user_permission
};

// Audit functions
pub use audit::{
    get_audit_logs, create_audit_log, get_audit_log_by_id, get_audit_stats
};

// Team functions
pub use team::{
    list_teams, get_team, create_team, update_team, delete_team,
    add_team_member, remove_team_member, get_team_members,
    assign_user_to_team, update_team_member_role, remove_user_from_team
};

// Asset functions
pub use asset::{
    list_assets, get_asset, create_asset, update_asset, delete_asset
};

// Report functions
pub use report::{
    list_reports, get_report, create_report, update_report, delete_report, download_report, generate_report
};

// Plugin functions
pub use plugin::{
    list_plugins, get_plugin, install_plugin, update_plugin, uninstall_plugin, toggle_plugin
};

// Dashboard functions
pub use dashboard::{
    get_dashboard_stats, get_network_topology
};

// Scanner import functions
pub use scanner_import::{
    list_scanners, import_scan_json, import_scan_file
};

// Remediation plan functions
pub use remediation_plan::{
    list_remediation_plans, get_remediation_plan, create_remediation_plan,
    update_remediation_plan, delete_remediation_plan
};

// Comments functions
pub use comments::{
    get_comments, create_comment, update_comment, delete_comment,
    get_user_mentions
};

// Password reset functions
pub use password_reset::{
    initiate_password_reset, confirm_password_reset, get_password_reset_status
};

// Resolution scoring functions
pub use resolution_scoring::{
    record_vulnerability_resolution, verify_resolution, get_user_resolution_stats,
    get_team_resolution_stats, get_resolution_leaderboard, get_team_leaderboard
};

// Risk scoring functions
pub use risk_scoring::{
    calculate_risk_score, get_sla_breaches, mark_sla_breaches,
    get_risk_statistics
};

// Workload tracking functions
pub use workload::{
    get_my_workload, get_user_workload, list_users_workload,
    get_team_workload, list_teams_workload
};

// Notification rules functions
pub use notification_rules::{
    list_notification_rules, get_notification_rule, create_notification_rule,
    update_notification_rule, delete_notification_rule, test_notification_rule,
    list_notification_channels, create_notification_channel, delete_notification_channel
};

// JIRA integration functions
pub use jira_integration::{
    list_jira_configurations, get_jira_configuration, create_jira_configuration,
    update_jira_configuration, delete_jira_configuration, test_jira_connection,
    list_jira_tickets, create_jira_ticket, sync_jira_ticket
};

// Compliance reports functions
pub use compliance_reports::{
    generate_compliance_report, list_compliance_reports
};

// SOAR webhooks functions
pub use soar_webhooks::{
    create_webhook, list_webhooks, delete_webhook, trigger_webhook
};

// Assignment rules functions
pub use assignment_rules::{
    create_assignment_rule, list_assignment_rules, get_assignment_rule,
    update_assignment_rule, delete_assignment_rule, test_assignment_rule
};

// Risk acceptance functions
pub use risk_acceptance::{
    create_risk_acceptance, list_risk_acceptances, get_risk_acceptance,
    approve_risk_acceptance, reject_risk_acceptance, renew_risk_acceptance,
    review_risk_acceptance
};

// User notifications functions (in-app bell notifications)
pub use user_notifications::{
    get_unread_count, list_notifications, mark_notification_read,
    mark_all_notifications_read, dismiss_notification
};

// Auto-assignment functions
pub use auto_assignment::{
    run_auto_assignment, get_assignment_history
};