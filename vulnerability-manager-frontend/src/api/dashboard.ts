// src/api/dashboard.ts
import apiClient from './client';

export interface DashboardStats {
  total_vulnerabilities: number;
  critical_vulnerabilities: number;
  high_vulnerabilities: number;
  medium_vulnerabilities: number;
  low_vulnerabilities: number;
  resolved_vulnerabilities: number;
  total_assets: number;
  vulnerable_assets: number;
  total_teams: number;
  total_users: number;
  recent_scans: number;
  open_remediations: number;
  in_progress_remediations: number;
  completed_remediations: number;
  top_teams: TeamPerformance[];
  top_users: UserPerformance[];
  recent_assignments: RecentAssignment[];
  vulnerability_trend: TrendData[];
  severity_distribution: SeverityDistribution;
  top_vulnerable_assets: AssetVulnerabilityCount[];
}

export interface TrendData {
  date: string;
  count: number;
}

export interface SeverityDistribution {
  critical: number;
  high: number;
  medium: number;
  low: number;
}

export interface AssetVulnerabilityCount {
  asset_name: string;
  asset_type: string;
  vulnerability_count: number;
}

export interface TeamPerformance {
  team_id: string;
  team_name: string;
  resolved_count: number;
  assigned_count: number;
  avg_resolution_time_days?: number;
}

export interface UserPerformance {
  user_id: string;
  username: string;
  resolved_count: number;
  assigned_count: number;
  avg_resolution_time_days?: number;
}

export interface RecentAssignment {
  vulnerability_id: string;
  title: string;
  severity: string;
  assigned_to_team?: string;
  assigned_to_user?: string;
  assigned_at: string;
}

export const dashboardApi = {
  // Get dashboard statistics
  getStatistics: async (): Promise<DashboardStats> => {
    const response = await apiClient.get<DashboardStats>('/api/dashboard/stats');
    return response.data;
  },
};

export default dashboardApi;
