// src/api/dashboard.ts
import apiClient from './client';

export interface DashboardStats {
  total_vulnerabilities: number;
  critical_vulnerabilities: number;
  high_vulnerabilities: number;
  medium_vulnerabilities: number;
  low_vulnerabilities: number;
  resolved_vulnerabilities: number;
  open_vulnerabilities: number;
  in_progress_vulnerabilities: number;
  total_assets: number;
  total_hosts: number;
  total_teams: number;
  total_users: number;
  recent_scans: number;
  vulnerabilities_found_today: number;
  vulnerabilities_resolved_today: number;
  monthly_trends: MonthlyTrend[];
  severity_distribution: SeverityDistribution;
  critical_hosts: CriticalHost[];
  recent_activities: RecentActivity[];
}

export interface MonthlyTrend {
  month: string;
  critical: number;
  high: number;
  medium: number;
  low: number;
  total: number;
}

export interface SeverityDistribution {
  critical: number;
  high: number;
  medium: number;
  low: number;
}

export interface CriticalHost {
  hostname: string;
  ip_address: string;
  vulnerability_count: number;
  critical_count: number;
  high_count: number;
}

export interface RecentActivity {
  id: number;
  activity_type: string;
  title: string;
  description: string;
  severity?: string;
  timestamp: string;
}

export const dashboardApi = {
  // Get dashboard statistics
  getStatistics: async (): Promise<DashboardStats> => {
    const response = await apiClient.get<DashboardStats>('/api/dashboard/stats');
    return response.data;
  },
};

export default dashboardApi;
