// src/api/dashboard.ts
import apiClient from './client';

export interface DashboardStats {
  total_vulnerabilities: number;
  critical_vulnerabilities: number;
  high_vulnerabilities: number;
  medium_vulnerabilities: number;
  low_vulnerabilities: number;
  resolved_vulnerabilities: number;
  total_assets: number;
  total_teams: number;
  total_users: number;
  recent_scans: number;
  vulnerability_trend: TrendData[];
  severity_distribution: SeverityDistribution;
  top_vulnerable_assets: AssetVulnerabilityCount[];
}

export interface TrendData {
  date: string;
  count: number;
}

export interface SeverityDistribution {
  critical: number;
  high: number;
  medium: number;
  low: number;
}

export interface AssetVulnerabilityCount {
  asset_name: string;
  asset_type: string;
  vulnerability_count: number;
}

export const dashboardApi = {
  // Get dashboard statistics
  getStatistics: async (): Promise<DashboardStats> => {
    const response = await apiClient.get<DashboardStats>('/dashboard/stats');
    return response.data;
  },
};

export default dashboardApi;
