// src/components/common/StatsCard.tsx
import React, { useState } from 'react';
import {
  Card,
  CardContent,
  Typography,
  IconButton,
  Box,
} from '@mui/material';
import { MoreVert as MoreVertIcon } from '@mui/icons-material';

interface StatsCardProps {
  title: string;
  value: number | string;
  color?: 'default' | 'success' | 'warning' | 'error' | 'info';
  description?: string;
}

const StatsCard: React.FC<StatsCardProps> = ({ title, value, color = 'default', description }) => {
  const [showInfo, setShowInfo] = useState(false);

  const getColorValue = () => {
    switch (color) {
      case 'success':
        return 'success.main';
      case 'warning':
        return 'warning.main';
      case 'error':
        return 'error.main';
      case 'info':
        return 'info.main';
      default:
        return 'text.primary';
    }
  };

  return (
    <Card sx={{ position: 'relative', height: '100%' }}>
      <CardContent>
        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
          <Box sx={{ flex: 1 }}>
            <Typography color="text.secondary" gutterBottom>
              {title}
            </Typography>
            <Typography variant="h4" color={getColorValue()}>
              {value}
            </Typography>
          </Box>
          {description && (
            <IconButton
              size="small"
              onClick={() => setShowInfo(!showInfo)}
              sx={{ mt: -1, mr: -1 }}
            >
              <MoreVertIcon />
            </IconButton>
          )}
        </Box>
      </CardContent>

      {/* Info Overlay */}
      {description && showInfo && (
        <Box
          sx={{
            position: 'absolute',
            top: 0,
            left: 0,
            width: '100%',
            height: '100%',
            backgroundColor: 'rgba(0, 0, 0, 0.95)',
            color: 'white',
            p: 3,
            zIndex: 1000,
            display: 'flex',
            flexDirection: 'column',
            justifyContent: 'center',
            cursor: 'pointer',
            overflow: 'auto',
          }}
          onClick={() => setShowInfo(false)}
        >
          <Typography variant="h6" sx={{ mb: 2, fontWeight: 600 }}>
            ℹ️ {title}
          </Typography>
          <Typography variant="body2" sx={{ lineHeight: 1.6, opacity: 0.95 }}>
            {description}
          </Typography>
          <Typography variant="caption" sx={{ mt: 2, opacity: 0.7 }}>
            Clicca ovunque per chiudere
          </Typography>
        </Box>
      )}
    </Card>
  );
};

export default StatsCard;
