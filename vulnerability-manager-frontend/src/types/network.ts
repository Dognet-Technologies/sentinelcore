// Network topology types for Entuity-style visualization

export interface NetworkDevice {
  id: string;
  name: string;
  hostname?: string;
  type: 'router' | 'switch' | 'server' | 'firewall' | 'gateway' | 'endpoint' | 'wireless' | 'storage' | 'database' | 'loadbalancer' | 'unknown';
  status: 'online' | 'offline' | 'warning' | 'maintenance' | 'unknown';
  ipAddress: string;
  macAddress?: string;
  location?: string;
  // System info
  manufacturer?: string;
  model?: string;
  osVersion?: string;
  vendor?: string;
  os_name?: string;
  os_version?: string;
  // Organization & management
  owner?: string;
  criticality?: string;
  tags?: string[];
  notes?: string;
  is_internet_facing?: boolean;
  has_public_ip?: boolean;
  assigned_user_id?: string;
  assigned_team_id?: string;
  // Vulnerability-specific metrics
  vulnerabilityMetrics?: {
    totalVulnerabilities: number;
    criticalCount: number;
    highCount: number;
    mediumCount: number;
    lowCount: number;
    resolvedCount: number;
    riskScore: number; // 0-100
    lastScanDate?: string;
    nextScanDate?: string;
    scanStatus?: 'pending' | 'running' | 'completed' | 'failed';
    complianceScore?: number; // 0-100
  };
  // Remediation info
  remediationInfo?: {
    lastRemediationDate?: string;
    lastRemediationType?: string;
    pendingRemediations: number;
    appliedRemediations: number;
    failedRemediations: number;
  };
  // Assignment info
  assignment?: {
    assignedTeamId?: string;
    assignedTeamName?: string;
    assignedUserId?: string;
    assignedUserName?: string;
    assignedDate?: string;
  };
  severity: 'critical' | 'high' | 'medium' | 'low' | 'info' | 'none';
  incidentCount: number;
  lastSeen: string;
  ports?: NetworkPort[];
}

export interface NetworkPort {
  id: string;
  number: number;
  name: string;
  type: string;
  status: 'up' | 'down' | 'disabled';
  speed: number; // Mbps
  duplex: 'full' | 'half' | 'auto';
}

export interface NetworkLink {
  id: string;
  source: string; // device id
  target: string; // device id
  sourcePort?: string;
  targetPort?: string;
  status: 'active' | 'inactive' | 'degraded';
  utilization: number; // 0-100
  bandwidth: number; // Mbps
  latency?: number; // ms
  packetLoss?: number; // percentage
  type: 'wired' | 'wireless' | 'virtual';
}

export interface NetworkTopology {
  devices: NetworkDevice[];
  links: NetworkLink[];
  lastUpdated: string;
}

export interface NetworkMetrics {
  totalDevices: number;
  onlineDevices: number;
  offlineDevices: number;
  criticalIncidents: number;
  warningIncidents: number;
  averageCpuUsage: number;
  averageMemoryUsage: number;
  totalBandwidth: number;
  usedBandwidth: number;
}

export interface TopologyFilter {
  deviceType?: string[];
  status?: string[];
  severity?: string[];
  location?: string;
  search?: string;
}

// Dashlet types
export type DashletType = 'keyinfo' | 'chart' | 'table' | 'map' | 'topology';

export interface Dashlet {
  id: string;
  type: DashletType;
  title: string;
  position: { x: number; y: number };
  size: { width: number; height: number };
  config: Record<string, any>;
}

export interface Dashboard {
  id: string;
  name: string;
  description?: string;
  type: 'static' | 'dynamic';
  dashlets: Dashlet[];
  createdAt: string;
  updatedAt: string;
}
